<html><head>

</head><body><div id="markdown-container"><h1 id="0">Getting Started</h1>
<p>Welcome! The mssql extension turns Visual Studio Code into a powerful development environment and code editor for Microsoft SQL Server, Azure SQL Databases and Data Warehouse evrywhere on Windows, Linux and macOS of your choice.

</p>
<p>In this step-by-step tutorial, we will walk you through how to:
<em> Connect to Microsoft SQL Server, Azure SQL Databases and Data Warehouses.
</em> Easily write T-SQL script with IntelliSense, T-SQL snippets, syntax colorization, real-time error validation and more!
<em> Execute the script against the connected database.
</em> View the result in a slick grid.
* Save the result to a json or csv file format.

</p>
<p>At the end, you will have a complete SQL Server development environment on your Windows, Linux or macOS. With that, you will be fully ready to venture into the exciting world of database development for your application.

</p>
<h3 id="1">Step 1. Download and install mssql extension from Visual Studio Code marketplace.</h3>
<ul>
<li>First, install Visual Studio Code and start it.</li>
<li>Then install the mssql extension by pressing <code>cmd+shift+p</code> or <code>F1</code> to open the command palette in Visual Studio Code, select <code>Install Extenion</code> and choose <code>mssql</code>.<ul>
<li>For macOS, you will need to install OpenSSL which is a pre-requiste for DotNet Core that mssql extention uses. Follow the 'install pre-requisite' steps in DotNet Core instruction page.</li>
<li>Or, simply run the following commands in your macOS Terminal.<pre><code class="lang-bash">  brew update
  brew install openssl
  ln -s /usr/local/opt/openssl/lib/libcrypto.1.0.0.dylib /usr/local/lib/
  ln -s /usr/local/opt/openssl/lib/libssl.1.0.0.dylib /usr/local/lib/</code></pre>
</li>
</ul>
</li>
<li>If you don't have SQL Server, Azure SQL Database or Data Warehouse to connect to yet, get Microsoft SQL Server, Azure SQL Database or Data Warehouse then continue to Step 2. Don't forget SQL Server 2016 Developer Edition or SQL on Linux and its Docker container for macOS is free to use.</li>
</ul>
<h3 id="2">Step 2. Open a new or existing *.sql file</h3>
<ul>
<li>Press <code>cmd+n</code>. Visual Studio Code opens a new 'Plain Text' file by default. Press <code>cmd+k,m</code> and change the language mode to <code>SQL</code>. </li>
<li>Or simply open a file with a .sql file extension. </li>
<li>The mssql extension looks for 'SQL' file type in the editor and activates commands and T-SQL IntelliSense on the .sql file. </li>
</ul>
<h3 id="3">Step 3. Create a new connection profile</h3>
<p>To make a connection to SQL Server, Azure SQL Databases or Data Warehouse, you need a connection profile which defines connection properties such as the server name, database name and user name. The mssql extension has a built-in wizard in the command palette that will help to create a new connection profile.

</p>
<ul>
<li>Press <code>F1</code>, and select <code>MS SQL: Manage Connection Profile</code>. You can simply type <code>sqlman</code> and press <code>enter</code>. Select <code>Create</code>.</li>
<li><p><code>Create</code> task will walk you through a few questions.</p>
<ul>
<li><strong>Server Name</strong>: type in your SQL Server instance name or type <code>localhost</code> if it is running on your local machine. To connect Azure SQL Database or Data Warehouse, get the server name from the Azure portal. Typically, it is <code>&lt;your-server-name&gt;.database.windows.net</code> format.</li>
<li><strong>Database Name</strong>: Type in the name of database your want to connect. If you don't specify and press <code>enter</code>, mssql will use the default value that is defined in the server such as <code>master</code> or <code>tempdb</code> for SQL Server. </li>
<li><strong>Authentication Type</strong>: If you run Visual Studio Code on Windows, the mssql extension will ask this question. Select <code>SQL Login</code> for this tutorial. On Linux and macOS, <code>SQL Login</code> is the only choice, hence the mssql extension will skip asking this question.</li>
<li><strong>User name</strong>: Type a valid user name for the SQL Server instance you will connect to.</li>
<li><strong>Password</strong>: Type a valid passowrd for the user.</li>
<li><strong>Save Password</strong>: Select <code>Yes</code>. The mssql extension securely stores the password in a secure store, for example KeyChain on macOS and get the password from KeyChain for the subsequent connections.</li>
<li><strong>Profile Name</strong>: Type <code>mssqlTutorial</code> or a name that you like. Providing a name to a connection profile will help you search it later when you have multiple connection profiles.</li>
<li><p>Check if the connection profile is successfully created.</p>
<p>If you want to use editor to manually create a connection profile or edit existing connection profiles, see manage connection profiles wiki page. Knowing this way can be handy if you want to copy an existing connection profile, paste then edit it to create multiple connection profiles or to define advanced connection properties.</p>
</li>
</ul>
</li>
</ul>
<h2 id="4">Step 4. Connect!</h2>
<ul>
<li>Press <code>F1</code> then type <code>sqlcon</code> or use <code>cmd+shift+c</code> shortcut to run <code>MS SQL: Connect</code> command. </li>
<li>Then select the connection profile <code>mssqlTutorial</code> and press <code>enter</code>. </li>
<li><p>Check if the connection was successful. You can view the connection status on the status bar.</p>
<p>  [image connection status] </p>
</li>
</ul>
<h2 id="5">Step 5. Write T-SQL script</h2>
<ul>
<li>In the editor, type <code>sql</code>. It will show the list of T-SQL snippets. Keep typing in <code>sqlcreate</code> and select <code>sqlCreateDatabase</code>.
  [image for snippet]</li>
<li><p>Type a database name in the snippet generated script in the editor, let's use <code>ClinicDB</code> for this tutorial. It will look like:</p>
<pre><code class="lang-sql">  -- Create a new database called 'Clinic'
  -- Connect to the 'master' database to run this snippet
  USE master
  GO
  -- Drop the database if it already exists
  IF EXISTS (
      SELECT name
      FROM sys.databases
      WHERE name = N'Clinic'
  )
  DROP DATABASE Clinic
  GO
  -- Create the new database
  CREATE DATABASE Clinic
  GO</code></pre>
</li>
<li><p>Type the following T-SQL query. As you type, IntelliSense will help you coding with suggestions and auto-completion. The mssql extension also validates the query for an error.</p>
<pre><code class="lang-sql">  SELECT * FROM sys.databases WHERE name = N'Clinic';
  GO

  SELECT
      c.session_id, c.net_transport,
      c.auth_scheme, s.program_name,
      s.client_interface_name, s.login_name,
      c.connect_time, s.login_time
  FROM sys.dm_exec_connections AS c
      JOIN sys.dm_exec_sessions AS s
      ON c.session_id = s.session_id
  WHERE c.session_id = @@SPID;
  GO</code></pre>
</li>
</ul>
<h3 id="6">Step 6. Execute</h3>
<ul>
<li>Press <code>F1</code> then type <code>sqlex</code> or use <code>cmd+shift+e</code> to run <code>MS SQL: Execute Query</code> command. If you want to change the shortcut to a simpler or somthinge familiar to you such as <code>F5</code> or <code>cmd+enter</code>, you can customize it. See customizing keyboard shortcuts wiki page.</li>
</ul>
<h3 id="7">Step 7. View and Save the result</h3>
<ul>
<li>You will see <code>CREATE DATABASE</code> statement execution result in the Messages and <code>SELECT</code> query result in the Results.</li>
<li>Try different split view layouts, horizontal and vertial. Running Visual Studio Code menu <code>View</code> --&gt; <code>Toggle Editor Group Layout</code> to switch the layout.</li>
<li>Play with following actions on the result view:<ul>
<li>Click <code>Results</code> bar to toggle collapse and expand.</li>
<li>Click <code>Messages</code> bar to toggle collapse and expand.</li>
<li>Click <code>Maximize / Restore</code> icon button on a grid.</li>
<li>See customize result view shortcuts wiki page for more actions and customizable shortcuts.</li>
</ul>
</li>
<li>Click the right mouse button on a grid to pop-up the result grid menu and run <code>Select all</code>. </li>
<li>Click the right mouse button on a grid then run <code>Save as JSON</code> or click its icon button on the right side of the grid.</li>
<li>Type a file name such as <code>myfile.json</code>. It will save the result as a .json file format and open the file in the editor.</li>
</ul>
<p>[image for playing with result view]

</p>
<h3 id="8">Step 8. Use Database command and see the recent connection list</h3>
<ul>
<li>Open a new file by pressing <code>cmd+n</code> then change the language mode to <code>SQL</code> by pressing <code>cmd+k,m</code> and type <code>SQL</code>.</li>
<li>Press <code>F1</code> and type <code>sqlcon</code> and select <code>mssqlTutorial</code> connection profile. Press <code>enter</code> to connect.</li>
<li>Press <code>F1</code> and type <code>sqluse</code> or use <code>cmd+shift+u</code> to run <code>MS SQL: Use Database</code> command. Then select <code>Clinic</code> from the database list to switch the connection to <code>Clinic</code> database from master.</li>
<li>Press <code>F1</code> and type <code>sqlcon</code> and press <code>enter</code>. You will see a new connection entry is added for the <code>Clinic</code> database. The mssql extension keeps the history of recent connections automatically. Next time, you can simply browse and select the newly added recent connection to connect to the <code>Clinic</code> database. </li>
</ul>
<h3 id="9">End of tutorial and play more by yourself</h3>
<p>Great! You have finished learning core features of the mssql extension. Play more with the sample T-SQL script below. Also explore other mssql features. Press <code>F1</code> and type <code>mssql</code> or <code>sql</code> to see the all supported commands from the mssql extension.
</p>
<pre><code class="lang-sql">    -- Create Patients table
    CREATE TABLE [dbo].[Patients]
    (
        [PatientId] [int] NOT NULL,
        [FirstName] [nvarchar](50) NOT NULL,
        [LastName] [nvarchar](50) NOT NULL,
        [Email] [nvarchar](50) NOT NULL,
        [City] [nvarchar](50) NULL,
        [MobileNumber] [nvarchar](50) NOT NULL
        PRIMARY KEY CLUSTERED ([PatientId] ASC) ON [PRIMARY]
    );
    GO

    -- Insert sample data into Patients table
    INSERT INTO [dbo].[Patients]([PatientId],[FirstName],[LastName],[Email],[City],[MobileNumber])
    VALUES
        (1, 'Amitabh', 'Bachchan', 'angry_young_man@gmail.com', 'Mumbai', '2620616212'),
        (2, 'Abhishek', 'Bachchan', 'abhishek@abhishekbachchan.org', 'Mumbai', '8890195228'),
        (3, 'Aishwarya', 'Rai', 'ash@gmail.com', 'Mumbai', '9991206339'),
        (4, 'Joe', 'Blogger', 'joe@blogger.org', 'Mumbai', '8988234567'),
        (5, 'Sally', 'Parker', 'sallyp@gmail.org', 'Pune', '8008123456'),
        (6, 'Kareena', 'Kapoor', 'bebo@kapoor.org', 'Mumbai', '8007891721')
    GO

    -- Query Patient records
    SELECT [FirstName], [LastName], [Email], [MobileNumber] FROM Patients;
    GO</code></pre>
</div>
</div>
</body></html>
